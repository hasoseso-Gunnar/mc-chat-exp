<template>
    <div class="q-pa-md items-start q-gutter-md">
        <div>
            <div class="text-left text-h4" style="font-weight: bold;">恋愛特論</div>
            <div class="text-subtitle2">2023/02/20 更新</div>
        </div>
        <q-img src="../assets/picturesForBlogs/me_with_3p.jpg" class="tatenaga_img"></q-img>
        <div class="text-subtitle2 text-right">これは、私が清廉潔白・品行方正かつ優等生だった高校時代の写真だ。(個人所蔵)</div>
        <div class="text-left text-h5 article_headline">はじめに</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                当サイトでは、<a href="https://forms.gle/JeF3vNd6t8aNchKX8" target="_blank">こちら</a>のフォームより私に語って欲しいことを
                リクエストとして常時募集している。本当にどんなことでもよいので、「いいね」を押す感覚よりも気軽に是非ともリクエストを送ってきてほしい。<br>
                <br>
                そして早速、当サイトを公開した約1時間半後に1通目のリクエストがペンネーム<strong>「同じ穴のゴリラ」</strong>氏より来た。<br>
            </p>
                <blockquote>
                    <p>
                        SEX論。SEXについて考えること。相手選びから、SEXまでの持っていき方、男と女が心通わせ交わるまでの全て、
                        好きな体位、いつものルーティン(まあ、個人的な問題はそこまで触れなくてもいい)。
                        とにかく、君自身が考えるSEX論をリクエストします。(原文ママ)
                    </p>
                </blockquote>
            <p style="font-size: 1rem; line-height: 180%;">
                同じ穴のゴリラ氏、リクエストありがとう。<br>
                正直、悪戯じみた際どい内容のものはいつか来るだろうと思ってはいたが、まさか一通目に来るとは思っていなかった。
                <a href="./thissite">「このサイトとは」</a>で語ったように、これは私のポートフォリオ的なサイトにしていくつもりなので、
                当然友人や知り合いだけでなく家族、職場の人間、あるいは転職活動の際に面接官等に確認される可能性もあるので、
                初っ端からこのリクエストを採用するかどうかかなり迷った。<br>
                しかしながら、ここでリクエストの採用基準に立ち返ってみると、<br>
                <br>
                　1.　私、そして多くの閲覧者にとって興味深い内容であること (読んでいて面白い・タメになる等)<br>
                　2.　私が知りうる・実行しうる範疇のリクエストであること (宇宙ステーションでの食レポ・フランス語の論文を読んでほしいなどは現時点では不可)<br>
                　3.　公共の福祉に反する内容でないこと (誰かを攻撃する・特定の人物を中傷することを示唆する内容は不可)<br>
                <br>
                なるほど、あくまでギリギリこれらに準ずるリクエスト内容であると言えよう。<br>
                また、同じ穴のゴリラ氏からは以下のような心温まるメッセージももらっている。<br>
            </p>
            <blockquote>
                <p>
                    何事も継続あるべき。飽きないでね。ちゃんと見るから。(原文ママ)
                </p>
            </blockquote>
            <p  style="font-size: 1rem; line-height: 180%;">
                ドぎついリクエストを送っておきながら、泣かせるメッセージを送ってくれるじゃないか。<br>
                ファンからのこんな厚意を無下にはできない。だから、私としてもこのリクエストにも快く対応しない訳にもいかないだろう。<br>
                <br>
                ただ、快く対応するとは言ったが、当サイトが破廉恥な質問で溢れかえり、
                私が破廉恥な回答をしていくというアンダーグラウンドな場になるのは当サイトの趣旨とは少々異なる。
                そのため、今回は頂いたリクエスト内容そのままだと少し生々し過ぎるので、
                私の現時点で考える<strong>「恋愛特論」</strong>(持論ではない)という形で、私の恋愛観全般を語りつつ、リクエスト内容にも時折触れて行くこととした。<br>
                リクエストをくれた同じ穴のゴリラ氏には申し訳ないが、当サイトは紳士淑女の諸君も見ているので、どうかこういった形で納得して頂きたい。<br>
                <br>
                それでは、以上のことを踏まえて論じていこう。<br>
            </p>
        </div>
        <div class="text-left text-h5 article_headline">Attemption Is All You Need</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                知っている人も多いかもしれないが、私は恋愛に関してはダメダメで、失敗だらけの人生である。
                諸君らの中には「コイツが恋愛を語るなんて甚だおこがましい」と思う者もいるだろう。<br>
                しかし、そんな私にも一つくらい二十余年で学んだことがある。どんな人間関係も「出会い」から始まり、
                人間関係においてそこが一番重要であるということだ。<br>
                <br>
                恋愛も含めた人付き合いというのは「出会い」というきっかけから始まる。出会いがなければ人とは知り合えない。
                そして、出会いは偶然だ。運命だ。また、全ての出会いの中でも、長い付き合いになる人はほんの一握りだ。
                言わずもがな、その中でも恋愛関係まで至る人というのはもっと少ない。<br>
                それにも関わらず、我々は欲張りだ。どうせなら「運命の人」と出会い、付き合いたい。<br>
                <br>
                <strong>では、自分の「運命の人」と出会うには何が必要か？</strong><br>
                <br>
                恋愛を宝くじに置き換えて考えてみよう。「運命の人」というのは、宝くじにおける「1等の3億円」だ。
                「1等の3億円」を当てに行く時に、我々は宝くじを一口だけ買うだろうか？
                少しでも当たる確率を高めるためにも10口以上買うだろう。1000口以上買う宝くじジャンキーも世の中にはいると思う。
                なんにせよ、宝くじで「1等の3億円」を当てるためには試行回数を積むことが大事だということは、諸君らも直観的に分かっているだろう。<br>
                <br>
                つまり、（非常につまらない回答で恐縮だが）恋愛において「運命の人」に出会うには<strong>「数をこなすしかない」</strong>というのが私の主張だ。<br>
                耳にタコができるくらい聞いた台詞かもしれない。しかし、何度も違う人から同じことを聞いたということは、結局それが正解なのだ。<br>
                ただ、「運命の人」に出会うには数をこなすしかない」というのはあまりにもつまらない回答なので、もう少し私の解釈を加えよう。
                恋愛というのは幸い宝くじほどランダムではない。場所や手段などである程度出会う人を選べる。
                こういったことを踏まえて「運命の人と出会う」必勝法をもう少し厳密に定義すると、<br>
                <br>
                <strong>　①　自分の「ゴール(友人関係・恋愛関係・肉体関係など)」を明確にする<br></strong>
                <strong>　②　そのうえで「付き合いたい人物」像を明確にする<br></strong>
                <strong>　③　そういった人物がいそうな場所(オンライン・オフライン問わず)に積極的に赴く<br></strong>
                <strong>　④　「ゴール」に辿り着くまで諦めずに試行回数をこなす<br></strong>
                <br>
                こんな具合だろうか。実際私も友人関係については、こんな感じのモットーに従って交友関係を積極的に広げている。<br>
                「出会いがない」と言っている人は①と③が欠けているのかもしれない。
                試行回数を積んでいるのに上手くいかないという人は、①と②を怠り闇雲に挑戦している可能性がある。<br>
                恋愛で行き詰っている諸君らに関しては、是非上記のルールを参考にしてはいかがだろうか。<br>
            </p>
        </div>
        <q-img src="../assets/picturesForBlogs/attention_is_all_you_need.png" class="insert_img"></q-img>
        <div class="text-subtitle2 text-right">本節のタイトル「Attemption Is All You Need」は自然言語処理に関するGoogleの超有名論文のタイトルをパロっているのだ。</div>
        <div class="text-left text-h5 article_headline">持つ者と持たざる者</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                前節において、私があることを巧妙に伏せて論じていたことに気付いた者もいるかもしれない。<br>
                それは、恋愛を成就するにあたり「試行回数を積まなくてもいい人」と「試行回数を積まなければいけない人」がいるということだ。
                いわゆる「モテる人間」と「モテない人間」のことだ。<br>
                <br>
                正直、モテる人間はさっきあげた4つのステップを踏む必要などない。夏の夜に光に虫が集まるように、
                待っていても向こうから勝手に「運命の人」やってくる。
                裏を返せば、悲しいかな、前節の内容も含め世の中のモテるテクニックというのは、負け犬のために存在しているのだ。<br>
                これを読んでいる私と同じ負け犬諸君は、図星を突かれたことで顔を真っ赤にし、今頃怒りに任せて自分のスマホなりPCに八つ当たりしていることだろう。<br>
                <br>
                では、モテる人間とはどんな人なのか。正直「男性からモテる女性」というのは、言うまでもなく皆が理解していると思う。
                そもそも男性というのは単純な生き物だから、求める女性像というのもシンプルなのだ。
                ここでは、女性がどうのこうの言って、フェミニスト諸君からの反感を買うのも嫌なので特に論じないことにする。<br>
                私がここで真に論じたいのは一般的な「女性からモテる男性」の特徴だ。
                こちらに関しては、私としてはなかなか考察の余地があると思っている。<br>
                私の好みのタイプの女性などを知りたかった諸君については残念だが、
                これ以上デジタルタトゥーをネットの海に垂れ流す訳には行かないので、ご勘弁願いたい。<br>
                <br>
                それでは、次節にて一般的な「男性からモテる女性」について論じていこう。<br>
            </p>
        </div>
        <div class="text-left text-h5 article_headline">モテる男性とは</div>
            <p style="font-size: 1rem; line-height: 180%;">

            </p>
        <div>
        </div>
    </div>
    <div class="q-pa-md items-start q-gutter-md">
        <div class="text-left text-h5 article_headline">お借りした画像の出典元</div>
        <div class="text-subtitle2 text-left">一部URLは表示の関係で省略</div>
        <div class="reference">
            <li style="margin-left: 3%;">https://towardsdatascience.com/</li>
        </div>
    </div>
    <div class="q-pa-md items-start q-gutter-md">
        <div class="text-left text-h5 article_headline">COMMENTS</div>
    </div>
    <div v-if="comments?.length === 0" style="font-size: 18px; margin-left: 20px;">コメントなし</div>
    <div v-for="comment in comments" :key="comment" class="comment_section">
        <q-card class="my-card bg-secondary text-white">
            <q-card-section>
                <div class="text-subtitle1">({{ comment.historyCommentId }}) {{ comment.historyName }}</div>
                <div class="text-subtitle2">{{ comment.historyTime }}</div>
            </q-card-section>

            <q-card-section class="text-subtitle1">
                {{ comment.historyText }}
            </q-card-section>

            <q-separator dark />

            <q-card-actions align="right">
                <q-btn flat @click="liked"><q-icon name="thumb_up_off_alt"></q-icon>({{ comment.historyLiked }})</q-btn>
            </q-card-actions>
        </q-card>
    </div>
    <div class="q-pa-md" style="max-width: 400px">
        <q-form
            @submit="onSubmit"
            @reset="onReset"
            class="q-gutter-md"
            >
            <q-input
                outlined
                v-model="name"
                label="ニックネーム *"
                hint="コメント欄に表示される名前"
                lazy-rules
                :rules="[ val => val && val.length > 0 || '必須項目です。']"
            />

            <q-input
                outlined
                type="textarea"
                v-model="text"
                label="コメント *"
                :rules="[ val => val && val.length > 0 || '必須項目です。']"
            />

            <q-toggle v-model="accept" color="purple-5" label="本当に送信しますか？" />

            <div>
                <q-btn label="送信" type="submit" color="purple-5"/>
                <q-btn label="リセット" type="reset" color="purple-5" flat class="q-ml-sm" />
            </div>
        </q-form>
    </div>
</template>
<script setup lang="ts">
import { ref, onMounted } from "vue";
    import { useQuasar } from "quasar";

    //ページを増やすときはここを必ず変える！
    const pageId = ref<string>('3');

    const $q = useQuasar();
    const name = ref<any>('');
    const text = ref<any>('');
    const accept = ref<boolean>(false);
    const display = ref<boolean>(false);

    function displayQuote(){
        display.value = true;
    };

    //コメント一覧
    const comments = ref<Array<any>>([]);

    // 画面読み込み時に実行
    onMounted(async () => {

        //GASにリクエスト送信
        const requestOptions = {
            method: 'POST',
            headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
            body: `page_id=${pageId.value}`,
        };

        const promise = await fetch("https://script.google.com/macros/s/AKfycbwbsbS1aOhLjrBFW652ieIVY27RbpkLqcYCgJO1R3JSswSXJtuB9-4qY8HhwGL12UCH/exec", requestOptions)
        const data = await promise.json();

        if(data){
            // 結果を挿入
            comments.value = data.res.map(function (value: any) {
                return {
                    historyCommentId: value.comment_id,
                    historyName: value.name,
                    historyText: value.text,
                    historyTime: value.time,
                    historyLiked: value.liked,
                };
            });

        }else{
            $q.notify({
                color: 'red-5',
                textColor: 'white',
                icon: 'warning',
                message: 'コメントの読み込みにエラーが発生しました。'
            });
        }

    })


    async function onSubmit () {
        if (accept.value !== true) {

            $q.notify({
                color: 'red-5',
                textColor: 'white',
                icon: 'warning',
                message: '「本当に送信しますか？」にチェックしてください'
            })

        }else{

            let date = new Date();
            let time = ref<string>(date.toLocaleString());

            //GASにリクエスト送信
            const requestOptions = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `page_id=${pageId.value}&comment_id=${comments.value.length + 1}&name=${name.value}&text=${text.value}&time=${time.value}&liked=0`,
            };

            const promise = await fetch("https://script.google.com/macros/s/AKfycbwchV_5zaDRk6nXZNhksLyFy5NFAJKrR73dg7eoEw7fXlgFgxsX1Z8AY5gWU-TnOXvPzQ/exec", requestOptions)
            const data = await promise.json();

            if(data.type == 'ok'){
            
                //送信完了通知
                $q.notify({
                    color: 'green-4',
                    textColor: 'white',
                    icon: 'cloud_done',
                    message: '送信しました'
                });

                comments.value[comments.value.length] = {
                    historyCommentId: comments.value.length + 1,
                    historyName: name.value,
                    historyText: text.value,
                    historyTime: time.value,
                    historyLiked: '0',
                };

                onReset();
            }else{
                $q.notify({
                    color: 'red-5',
                    textColor: 'white',
                    icon: 'warning',
                    message: 'エラーが発生しました。'
                });
            };
        };
    }

    function onReset (){
        name.value = ''
        text.value = ''
        accept.value = false
    }

    function liked () {
        $q.notify({
            color: 'green-4',
            textColor: 'white',
            icon: 'thumb_up_off_alt',
            message: 'いいね機能近日実装予定'
        });
    }
</script>
<style scoped>
    blockquote {
        margin: 0;
    }

    blockquote p {
        padding: 15px;
        background: #eee;
        border-radius: 5px;
    }

    strong{
        font-weight: bold
    }

    .responsive_flex{
        display: flex;
    }

    .insert_img{
        width:70%;
        margin-left: 15%;
    }
    .tatenaga_img{
        height: 400px;
        width: 50%;
        margin-left: 25%;
    }

    .comment_section{
        max-width: 400px; 
        margin-left: 10px;
        margin-bottom: 10px;
    }

    @media screen and (max-width: 1024px){
        div.responsive_flex{
            display: block;
        }
        div.insert_img{
            width:90%;
            margin-left: 5%;
        }
        div.comment_section{
            max-width: 90%; 
            margin-left: 5%;
            margin-bottom: 10px;
        }
        div.tatenaga_img{
            height: 300px;
            width: 90%;
            margin-left: 5%;
        }
    }
    .article_headline{
        font-weight: bold;
        margin-top: 30px;
        padding: 0.4em 0.5em;
        color: #494949;
        background: #f4f4f4;
        border-left: solid 5px #9c27b0;
        border-bottom: solid 3px #d7d7d7;
    }
</style>