<template>
    <div class="q-pa-md items-start q-gutter-md">
        <div>
            <div class="text-left text-h4" style="font-weight: bold;">アメリカ渡航体験記 1日目</div>
            <div class="text-subtitle2">2023/02/28 更新</div>
        </div>
        <q-img src="../assets/picturesForBlogs/atlanta.jpg" class="yokonaga_img"></q-img>
        <div class="text-subtitle2 text-right">これは、私の泊まったホテルの部屋からのアトランタ市街の風景だ。</div>
        <div class="text-left text-h5 article_headline">いざアメリカ</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                ご存じの諸君もいるかと思うが、私は<a href="https://spsp.org/" target="_blank">SPSP(Society for Personality and Social Psychology)</a>の年次学会に参加するために2023年2月22日〜27日の間にアメリカに出張することになった。<br>
                諸君もコロナがようやく終焉を迎え、海外旅行に行きたいと思い始めている者もいると思うので、
                今回は特にアメリカ旅行をするに当たって必要な事務的な手続きから、現地の実際の様子に至るまで記し、
                実際に旅行をする人のための指南書として書き記して行こうと思う。<br>
                <br>
                なお、本記事の内容は2023年2月末までの時点の話であり、将来的に書かれていることがアテにならなくなる可能性がある。
                本記事は過去の記事を情勢に応じて頻繁にアップデートする予定などはないので、古い情報が混じっていることについては予めご了承頂きたい。<br>
                <br>
                それでは、早速語っていこう。
            </p>
        </div>
        <div class="text-left text-h5 article_headline">事前準備編</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                アメリカ渡航に際して、アメリカへの入国は「ESTA」の申請が不可欠である。
                これは、最近導入されたアメリカ入国時のビザの代わりになるもので、
                一度申請すれば以降は2年ほど90日の滞在がビザなしで行える。<br>
                帰国には「Visit Japan」の登録をしたほうが良い。
                これを登録するだけで、帰国した際にスムーズに手続きが済ませられる。<br>
                また、入国帰国どちらもワクチン接種証明書(3回目まで)が必要である。
                もちろん、何か理由があってワクチン接種を行えない場合は、医師からの証明書さえあれば考慮してもらえるようだ。
                いずれの手続きも早く済ませるに越したことはないが、割とギリギリでもどうにかなるので、忘れていても焦らず完了させよう。<br>
                <br>
                ホテルと飛行機については、実際の渡航の2ヶ月くらい前までに行うのが良いかと思う。
                なぜなら、直前になればなるほど値段が高くなるからだ。
                ただ、めちゃくちゃ円安の時に予約をしてしまうと損するので、多少円高になったタイミングを見計らうのが良いだろう。<br>
                <br>
                また、ホテルや飛行機の値段は基本的に「信頼」と「料金」のトレードオフだと思った方がよい。
                例えば、同じ地域にあるホテルでも値段が高ければ清掃員に持ち物を盗まれたりすることもなく、周辺の治安も良いことが多い。
                しかし、値段が低いホテルは持ち物の紛失が頻繁に起こったり、周辺の治安が悪いことが多分にある。<br>
                飛行機も、値段が安いからといって墜落することはないが、機内サービスが適当である可能性が高い。
                水が頻繁に飲めない、トイレが汚い、椅子が狭くて硬い、などの問題は2時間程度であれば耐えられるが、
                10時間以上のフライトとなってくるとかなりキツい。<br>
                <br>
                なんにせよ、口コミなどを見て「信頼」と「料金」が釣り合っている会社のサービスを受けるのが一番である。
                もし口コミを見ても分からないようであれば、多少値段が張っても「聞いたことがあるところ」を利用する、というのも手だろう。
            </p>
        </div>
        <q-img src="../assets/picturesForBlogs/haneda.jpg" class="yokonaga_img"></q-img>
        <div class="text-subtitle2 text-right">これは、出発する前の羽田空港の写真だ。割とガラガラ。</div>
        <div class="text-left text-h5 article_headline">羽田空港〜飛行機内編</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                あまり海外旅行に馴染みがない諸君らにもフライトの仕組みを説明しておくと、
                航空券などに記させれている「フライトの時間」というのは文字通り飛行機が「離陸する時間」のことを指している。
                そのため、「大体フライトの時間に着けば大丈夫だろう」と思っていると大間違いである。
                フライトの前には後述するいくつかの手続きを踏む必要があるので、どんなに遅くてもフライトの3時間前までには空港に着くことが望ましい。<br>
                <br>
                今回、私は羽田空港にフライト(19:20)の4時間前の15:30に到着した。まず、着いてすぐ行うべきなのは、フライトのチェックインである。
                これに関しては早めにした方が良い。なぜなら、一部手続きのミスなどがあった際にその場で対応できる可能性が高まるからだ。
                その後は、買い忘れた備品や現地で会う人がいればお土産などを空港で買って時間を潰すのが良いだろう。<br>
                <br>
                また、今回はアメリカ渡航ということでチップが必要になるかと思い、現金を用意した。
                その際の換金レートは約1ドル132円。1万円が72ドルと少しの小銭になって帰ってきた、といった感じだ。
                こうしてみると、かなり円安の影響は大きいように思う。<br>
                <br>
                フライトの1時間半、できれば2時間前までには保安検査所を通っておくのが良いだろう。
                保安検査所では、飛行機内への手荷物での飲み物やハサミを含めた刃物の持ち込みを禁じている。
                こういったものを持ち運びたい時には、チェックイン前に予め手荷物からスーツケースに移動させておくと良いだろう。<br>
                <br>
                そして、およそフライトの1時間前からは搭乗が始まる。
                今回は搭乗口が羽田空港第3ターミナルの140番口であったので、保安検査所から歩いて15〜20分ほど掛かった。
                そのため、やはり保安検査所は1時間半前には通過しておきたい。
                <br>
                そしていざ搭乗、離陸した。<br>
                <br>
                今回使用したのは唯一直行便があったデルタ航空(厳密にはベトナム航空とのコードシェア便)。フライト時間は約11時間。
                飛行機内は思ったよりもガラガラ。隣の人がいない列の人は3席使って横になって寝ていた。
                私も通路側で隣の人がいないという形だったので、それに関しては非常にストレスフリーであった。
                機内食は至って普通。基本的にはドリンクや食事などをCAが運んできてくれるが、
                機内最後尾に行くと自分でお菓子や水分なども自由に補給できるようになっているので、長距離飛行の場合は利用すべし。<br>
                <br>
                予定では、飛行機内で適当に寝て、起きている時間は資料の作成に充てるつもりだったが、
                結局1時間程度しか寝れず、おまけに暗すぎてPCで作業する気持ちも起きなかった。
                代わりに、フライト中はスマホに入れたオフラインでも遊べるアプリか映画を見て過ごしていた。
                今回機内で視聴したのは『Coraline(邦題:コララインとボタンの魔女)』と『The Big Lebowski』と『NOPE』。<br>
                <br>
                『Coraline』はストップモーションの映画。ストップモーションとは、『ナイトメアー・ビフォー・クリスマス』や『ピングー』のように、
                人形を一コマずつ微妙に位置を変えながら撮影していき、最終的にコマ送りにした際に動いて見えるタイプのアニメ映画だ。
                タイトルとポスターだけ見るとポップな感じで子供向けの映画かと思いきや、実際はかなりダークな世界観。
                油断していると唐突なグロ描写に驚かされてしまうだろう。
                ただ、映像の作りこみが素人でも分かるレベルでも素晴らしく、見ていてとても楽しい映画だった。<br>
                <br>
                『The Big Lebowski』は90年代のB級(C級?)映画だが、今日ではカルト的な人気を誇る映画だ。
                ストーリーは伏線なども特に存在せず、至ってシンプル。主人公が奇妙な運命に翻弄される顛末は、見ていて楽しかった。
                セリフの言い回しや、主人公がハイになった際の映像の斬新さなどがカルト映画として持て囃される所以だろうか。<br>
                <br>
                『NOPE』は2022年制作のほぼ最新ホラー映画。これに関しては、名前だけ聞いたことがあってほぼ前情報なしで視聴したが、(ホラー映画ということさえ途中で気付いた)
                かなり面白かった。諸君らの中には「ホラー映画なんて絶対無理」と思う者もいるかもしれないが、この映画はそこまで「ビックリ系」の演出はなく、
                じりじりと迫りくる、また逃れられない恐怖を丁寧に描写していたように思う。
                映像だけでなく、サウンドトラックにもこだわりが感じられたので、その点もオススメできる。<br>
                <br>
                なんだかんだで2時間の映画を3本も見ているうちに11時間のフライトはあっという間に過ぎ、
                19:20に羽田空港を発った飛行機は、時差の関係で2時間戻って現地時間17:20にアメリカはハーツフィールド・ジャクソン・アトランタ国際空港に着陸しようとしていた...。
            </p>
        </div>
        <q-img src="../assets/picturesForBlogs/atlanta_airport.jpg" class="yokonaga_img"></q-img>
        <div class="text-subtitle2 text-right">アトランタ国際空港内の写真。空港のホームページには「世界一忙しい空港」などと大層なことが書かれているが、実際はこじんまりとしていた。</div>
        <div class="text-left text-h5 article_headline">アメリカ到着直後編</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                アメリカ(アトランタ)に到着してからは、入国審査がとにかくキツかった。
                11時間のフライトでくたくたなのに空港での1時間ほど立ちっぱなしで並ばされた。
                挙句、自分が当たった列の入国審査官は非常に厳しく、自分よりも前に並んでいた日本人3人くらいが別室に連れていかれていた。
                英語での受け答えがスムーズにできなかったことが要因のようであった。
                このようなことが実際にあるので、アメリカ渡航に際して「言語の壁はなんとかなるっしょ」と思っている人も、入国審査の練習はしておいた方がいい。<br>
                <br>
                スーツケースを受け取ってからは、特にやることもないのですぐに空港を出た。
                空港からダウンタウン(街の中心)まではタクシーを使うのが一般的とのことで、
                他に待ち合わせていた知り合いも含め計3人でタクシーに相乗りすることになった。<br>
                日本人ならバスや電車などの公共交通機関を利用したくなってしまうが、
                アメリカのバスや電車は治安がかなり悪いので、現地のガイドなどと一緒でない限り、
                利用することは避けよう。<br>
                我々が利用したタクシーの運転手は(恐らく)ラテン系の方で英語に訛りがあり、聞き慣れていない人はかなり苦労するだろう。
                アメリカにはアフリカ系やメキシコなどのラテン系、あとはヨーロッパ系などの様々な英語を話す人がおり、
                英語に訛りがある人と話すときにはかなりの苦戦が予想される。<br>
                <br>
                タクシーについては、空港からダウンタウンまでは$30が相場というのが事前情報であったので、<br>
                1人あたり10ドル(1300円)+チップというつもりでいた。
                しかし、実際に請求されたのは75ドルで、1人あたり25ドル(3250円)という計算。
                運転手いわく、<br>
                <br>
                ・3人載せたこと<br>
                ・高速道路などを使って最短ルートを通ったこと<br>
                ・荷物をトランクに運び入れたこと<br>
                <br>
                などが高くなったことの原因だと主張。
                流石におかしいだろうと思い、こちらから値下げの交渉。
                こちらの値下げの主張は、<br>
                <br>
                ・相場は$30ドルというのを事前に知っている<br>
                ・あなたの生活が大変なのは分かるが、こちらも学生で払いたくてもお金がない<br>
                ・(ボッタクリなのは相手も承知なので)これ以上大ごとにしたくない、と最悪の場合は警察を呼ぶことを仄めかす<br>
                <br>
                とりあえず、以上のような論法を用いてチップ込みの60ドルまで値下げした。それでも、一人頭20ドル(約3600円)といきなりの手痛い出費であった。
            </p>
        </div>
        <q-img src="../assets/picturesForBlogs/hilton_atlanta.jpg" class="yokonaga_img"></q-img>
        <div class="text-subtitle2 text-right">私が泊まったホテルの内装。一応荷物が物色された時に備えて、毎朝立ち去る前に部屋の写真を取っておいた。</div>
        <div class="text-left text-h5 article_headline">ホテル～就寝編</div>
        <div>
            <p style="font-size: 1rem; line-height: 180%;">
                その後無事ホテルに到着した...が、ホテルのことに関してはあまり語りたくない。正直、高い金を払った割には不満点が非常に多かった。<br>
                ちなみに、今回私が泊まったホテルを含め海外にはチェックインの際に「デポジット」を求められることがある。
                日本ではあまり馴染みのないものだが、これはルームサービスを利用するだけしてお金を払わないケースや部屋の備品を損壊して、
                そのまま逃げられないようにするためのホテル側の「保険」、宿泊客にとっては「人質」的なシステムである。<br>
                当然ルームサービスを利用したり備品を壊さなければ全額返ってくる(私も後日返ってきた)ので、
                ホテルに着くや否や大きな額の支払いを請求されて戸惑うかもしれないが、これは先ほどのようなボッタくりではないので素直に払おう。<br>
                <br>
                そんなこんなで私はチェックインを済ませ、そのまま部屋に入った瞬間、文字通り「バタンキュー」であった。
                まぁ、ほぼ20時間ほどぶっ続けで起きていたので、仕方のないことだろう。
                よほど疲れていたのかその夜は悪夢にうなされ、私が泊まった部屋は16階だったためか、16階のビルから落ちる夢を見た。<br>
                <br>
                以上が1日目までの大雑把な手続き・起きた事柄である。
                文字に書き出してみると、割と見どころもなく1日が過ぎたように思えるが、私にとっては最初から最後まで気を抜けない1日だった。
                疲れていた+あまり見どころが無かったので現地の写真が少ないことは許してほしい。また2日目以降の記事の更新を待っていてもらえると助かる。<br>
                <br>
                以上。
            </p>
        </div>
    </div>
    <div class="q-pa-md items-start q-gutter-md">
        <div class="text-left text-h5 article_headline">COMMENTS</div>
    </div>
    <div v-if="comments?.length === 0" style="font-size: 18px; margin-left: 20px;">コメントなし</div>
    <div v-for="comment in comments" :key="comment" class="comment_section">
        <q-card class="my-card bg-secondary text-white">
            <q-card-section>
                <div class="text-subtitle1">({{ comment.historyCommentId }}) {{ comment.historyName }}</div>
                <div class="text-subtitle2">{{ comment.historyTime }}</div>
            </q-card-section>

            <q-card-section class="text-subtitle1">
                {{ comment.historyText }}
            </q-card-section>

            <q-separator dark />

            <q-card-actions align="right">
                <q-btn flat @click="liked"><q-icon name="thumb_up_off_alt"></q-icon>({{ comment.historyLiked }})</q-btn>
            </q-card-actions>
        </q-card>
    </div>
    <div class="q-pa-md" style="max-width: 400px">
        <q-form
            @submit="onSubmit"
            @reset="onReset"
            class="q-gutter-md"
            >
            <q-input
                outlined
                v-model="name"
                label="ニックネーム *"
                hint="コメント欄に表示される名前"
                lazy-rules
                :rules="[ val => val && val.length > 0 || '必須項目です。']"
            />

            <q-input
                outlined
                type="textarea"
                v-model="text"
                label="コメント *"
                :rules="[ val => val && val.length > 0 || '必須項目です。']"
            />

            <q-toggle v-model="accept" color="purple-5" label="本当に送信しますか？" />

            <div>
                <q-btn label="送信" type="submit" color="purple-5"/>
                <q-btn label="リセット" type="reset" color="purple-5" flat class="q-ml-sm" />
            </div>
        </q-form>
    </div>
</template>
<script setup lang="ts">
import { ref, onMounted } from "vue";
    import { useQuasar } from "quasar";

    //ページを増やすときはここを必ず変える！
    const pageId = ref<string>('4');

    const $q = useQuasar();
    const name = ref<any>('');
    const text = ref<any>('');
    const accept = ref<boolean>(false);
    const display = ref<boolean>(false);

    function displayQuote(){
        display.value = true;
    };

    //コメント一覧
    const comments = ref<Array<any>>([]);

    // 画面読み込み時に実行
    onMounted(async () => {

        //GASにリクエスト送信
        const requestOptions = {
            method: 'POST',
            headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
            body: `page_id=${pageId.value}`,
        };

        const promise = await fetch("https://script.google.com/macros/s/AKfycbwbsbS1aOhLjrBFW652ieIVY27RbpkLqcYCgJO1R3JSswSXJtuB9-4qY8HhwGL12UCH/exec", requestOptions)
        const data = await promise.json();

        if(data){
            // 結果を挿入
            comments.value = data.res.map(function (value: any) {
                return {
                    historyCommentId: value.comment_id,
                    historyName: value.name,
                    historyText: value.text,
                    historyTime: value.time,
                    historyLiked: value.liked,
                };
            });

        }else{
            $q.notify({
                color: 'red-5',
                textColor: 'white',
                icon: 'warning',
                message: 'コメントの読み込みにエラーが発生しました。'
            });
        }

    })


    async function onSubmit () {
        if (accept.value !== true) {

            $q.notify({
                color: 'red-5',
                textColor: 'white',
                icon: 'warning',
                message: '「本当に送信しますか？」にチェックしてください'
            })

        }else{

            let date = new Date();
            let time = ref<string>(date.toLocaleString());

            //GASにリクエスト送信
            const requestOptions = {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded',
                },
                body: `page_id=${pageId.value}&comment_id=${comments.value.length + 1}&name=${name.value}&text=${text.value}&time=${time.value}&liked=0`,
            };

            const promise = await fetch("https://script.google.com/macros/s/AKfycbwchV_5zaDRk6nXZNhksLyFy5NFAJKrR73dg7eoEw7fXlgFgxsX1Z8AY5gWU-TnOXvPzQ/exec", requestOptions)
            const data = await promise.json();

            if(data.type == 'ok'){
            
                //送信完了通知
                $q.notify({
                    color: 'green-4',
                    textColor: 'white',
                    icon: 'cloud_done',
                    message: '送信しました'
                });

                comments.value[comments.value.length] = {
                    historyCommentId: comments.value.length + 1,
                    historyName: name.value,
                    historyText: text.value,
                    historyTime: time.value,
                    historyLiked: '0',
                };

                onReset();
            }else{
                $q.notify({
                    color: 'red-5',
                    textColor: 'white',
                    icon: 'warning',
                    message: 'エラーが発生しました。'
                });
            };
        };
    }

    function onReset (){
        name.value = ''
        text.value = ''
        accept.value = false
    }

    function liked () {
        $q.notify({
            color: 'green-4',
            textColor: 'white',
            icon: 'thumb_up_off_alt',
            message: 'いいね機能近日実装予定'
        });
    }
</script>
<style scoped>
    blockquote {
        margin: 0;
    }

    blockquote p {
        padding: 15px;
        background: #eee;
        border-radius: 5px;
    }

    strong{
        font-weight: bold
    }

    .responsive_flex{
        display: flex;
    }

    .insert_img{
        width:70%;
        margin-left: 15%;
    }
    .tatenaga_img{
        height: 400px;
        width: 50%;
        margin-left: 25%;
    }

    .comment_section{
        max-width: 400px; 
        margin-left: 10px;
        margin-bottom: 10px;
    }

    .yokonaga_img{
        width: 100%;
        height: 400px;
    }

    @media screen and (max-width: 1024px){
        div.responsive_flex{
            display: block;
        }
        div.insert_img{
            width:90%;
            margin-left: 5%;
        }
        div.comment_section{
            max-width: 90%; 
            margin-left: 5%;
            margin-bottom: 10px;
        }
        div.tatenaga_img{
            height: 300px;
            width: 90%;
            margin-left: 5%;
        }
        .yokonaga_img{
            height: 300px;
            width: 90%;
            margin-left: 5%;
        }
    }
    .article_headline{
        font-weight: bold;
        margin-top: 30px;
        padding: 0.4em 0.5em;
        color: #494949;
        background: #f4f4f4;
        border-left: solid 5px #9c27b0;
        border-bottom: solid 3px #d7d7d7;
    }
</style>